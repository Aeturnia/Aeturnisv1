import{j as e}from"./query-vendor-VBf2NspY.js";import{r as i}from"./router-vendor-Cn6bChYk.js";import{d as g,b as w,a as k}from"./index-DUBnp2Sp.js";import"./react-vendor-BtP0CW_r.js";import"./gesture-vendor-CKK3uJth.js";const x=s=>{switch(s.item.itemType){case"weapon":return"⚔️";case"armor":return s.item.equipmentSlot==="head"?"🪖":(s.item.equipmentSlot==="chest","🛡️");case"consumable":return"🧪";case"material":return"💎";case"accessory":return"💍";default:return"📦"}};function R(){const[s,r]=i.useState(null),[d,o]=i.useState("grid"),[y,h]=i.useState(!0),[n,j]=i.useState([]),[c,b]=i.useState({usedSlots:0,maxSlots:100,weight:0,maxWeight:1e3}),{getInventory:N,dropItem:v}=g(),{currentCharacter:a}=w();i.useEffect(()=>{a!=null&&a.id&&u()},[a]);const u=async()=>{if(a!=null&&a.id)try{h(!0);const t=await N(a.id);j(t.items),b({usedSlots:t.usedSlots,maxSlots:t.maxSlots,weight:t.weight,maxWeight:t.maxWeight})}catch(t){console.error("Failed to load inventory:",t)}finally{h(!1)}},f=async t=>{if(a!=null&&a.id)try{await v(a.id,t.id,t.quantity),r(null),await u(),l("success")}catch(m){console.error("Failed to drop item:",m),l("error")}},{hapticFeedback:l}=k({onTap:()=>{l("light")}}),p=t=>{switch(t){case"common":return"border-gray-500";case"uncommon":return"border-green-500";case"rare":return"border-blue-500";case"epic":return"border-purple-500";case"legendary":return"border-yellow-500";case"mythic":return"border-red-500";default:return"border-gray-500"}};return y?e.jsx("div",{className:"h-full bg-dark-900 p-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-4 animate-spin",children:"🎒"}),e.jsx("p",{className:"text-white",children:"Loading inventory..."})]})}):a?e.jsxs("div",{className:"h-full bg-dark-900 p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Inventory"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>o("grid"),className:`btn-touch px-3 py-1 rounded ${d==="grid"?"bg-primary-500":"bg-dark-700"}`,children:"Grid"}),e.jsx("button",{onClick:()=>o("list"),className:`btn-touch px-3 py-1 rounded ${d==="list"?"bg-primary-500":"bg-dark-700"}`,children:"List"})]})]}),e.jsx("div",{className:"bg-dark-800 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-dark-400",children:["Items: ",c.usedSlots,"/",c.maxSlots]}),e.jsxs("span",{className:"text-dark-400",children:["Weight: ",c.weight,"/",c.maxWeight," kg"]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto momentum-scroll",children:d==="grid"?e.jsxs("div",{className:"grid grid-cols-4 gap-2 sm:grid-cols-6 md:grid-cols-8",children:[n.map(t=>e.jsxs("div",{className:`card p-2 border-2 ${p(t.item.rarity)} cursor-pointer relative`,onClick:()=>{r(t),l("light")},children:[e.jsx("div",{className:"text-2xl text-center mb-1",children:x(t)}),e.jsx("div",{className:"text-xs text-center text-white truncate",children:t.item.name}),t.quantity>1&&e.jsx("div",{className:"absolute top-1 right-1 bg-primary-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:t.quantity})]},t.id)),n.length===0&&e.jsxs("div",{className:"col-span-full text-center py-8 text-dark-400",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📦"}),e.jsx("p",{children:"Your inventory is empty"})]})]}):e.jsxs("div",{className:"space-y-2",children:[n.map(t=>e.jsxs("div",{className:`card p-3 border-l-4 ${p(t.item.rarity)} cursor-pointer flex items-center space-x-3`,onClick:()=>{r(t),l("light")},children:[e.jsx("div",{className:"text-2xl",children:x(t)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white font-medium",children:t.item.name}),e.jsx("div",{className:"text-xs text-dark-400",children:t.item.description})]}),t.quantity>1&&e.jsx("div",{className:"bg-primary-500 text-white text-sm rounded-full px-2 py-1",children:t.quantity})]},t.id)),n.length===0&&e.jsxs("div",{className:"text-center py-8 text-dark-400",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📦"}),e.jsx("p",{children:"Your inventory is empty"})]})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:()=>r(null),children:e.jsxs("div",{className:"card p-6 max-w-sm w-full",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"text-4xl mb-2",children:x(s)}),e.jsx("h3",{className:"text-xl font-bold text-white",children:s.item.name}),e.jsxs("p",{className:"text-sm text-dark-400 capitalize",children:[s.item.rarity," ",s.item.itemType]})]}),e.jsx("p",{className:"text-white mb-4",children:s.item.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[s.quantity>1&&e.jsxs("p",{className:"text-sm text-dark-400",children:["Quantity: ",s.quantity]}),s.item.levelRequirement>1&&e.jsxs("p",{className:"text-sm text-dark-400",children:["Level Required: ",s.item.levelRequirement]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-dark-400",children:"Buy Price:"}),e.jsxs("span",{className:"text-yellow-400",children:[s.item.buyPrice," gold"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-dark-400",children:"Sell Price:"}),e.jsxs("span",{className:"text-yellow-400",children:[s.item.sellPrice," gold"]})]})]}),s.item.stats&&s.item.stats.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-2",children:"Stats:"}),e.jsx("div",{className:"space-y-1",children:s.item.stats.map((t,m)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-dark-400 capitalize",children:[t.statType,":"]}),e.jsxs("span",{className:"text-green-400",children:["+",t.value,t.isPercentage?"%":""]})]},m))})]}),e.jsxs("div",{className:"flex space-x-2",children:[s.item.itemType==="consumable"&&e.jsx("button",{className:"btn-touch btn-primary flex-1",children:"Use"}),(s.item.itemType==="weapon"||s.item.itemType==="armor")&&e.jsx("button",{className:"btn-touch btn-primary flex-1",children:"Equip"}),e.jsx("button",{className:"btn-touch btn-secondary flex-1",onClick:()=>f(s),children:"Drop"})]})]})})]}):e.jsx("div",{className:"h-full bg-dark-900 p-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🎒"}),e.jsx("p",{className:"text-white",children:"No character selected"})]})})}export{R as InventoryScreen};
